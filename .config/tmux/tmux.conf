set-option -sa terminal-overrides ",xterm*Tc"
set -g automatic-rename on

# Enable image preview in yazi
set -g allow-passthrough on
set -ga update-environment TERM
set -ga update-environment TERM_PROGRAM

# Start windows and panes at 1, not 0
set -g base-index 1
set -g pane-base-index 1
set-option -g renumber-windows on

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'alexwforsythe/tmux-which-key'

# Custom rainbow statusline
set -g status-style bg=#4d3d52
set -g status-justify left

# Prefix indicator
set -g status-left-length 100
set -g status-left "#{?client_prefix,#[fg=#4d3d52]#[bg=#d99368]#[bold] PREFIX #[fg=#d99368]#[bg=#4d3d52],#[fg=#4d3d52]#[bg=#85c4b8] READY #[fg=#85c4b8]#[bg=#4d3d52]}"

# Rainbow status-right
set -g status-right-length 100
set -g status-right ""

# Window status format (blue for inactive, yellow for active)
set -g window-status-current-format "#[fg=#4d3d52,bg=#d9c9a0]#[fg=#4d3d52,bg=#d9c9a0,bold] #I:#W #[fg=#d9c9a0,bg=#4d3d52]"
set -g window-status-format "#[fg=#4d3d52,bg=#7d9dcc] #I:#W #[fg=#7d9dcc,bg=#4d3d52]"

# Pane border colors - matching lualine palette
set -g pane-border-style "fg=#7c6f9f"
set -g pane-active-border-style "fg=#d99368"
set -g pane-border-lines "single"
set -g pane-border-status off

# set vi-mode
set-window-option -g mode-keys vi

# keybindings
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel

# Launch rmpc music player in new window
bind-key t new-window -n "music" "rmpc"

set -g mouse on

# Scroll history
set -g history-limit 10000

# Enable focus events for better mouse integration
set -g focus-events on

# Mouse wheel scrolling
bind -n WheelUpPane if-shell -F -t = "#{mouse_any_flag}" "send-keys -M" "if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t=; copy-mode -e; send-keys -M'"
bind -n WheelDownPane select-pane -t= \; send-keys -M

# Keep mouse selections visible (don't auto-cancel)
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-selection

# Double click to select word (without canceling copy mode)
bind -T copy-mode-vi DoubleClick1Pane select-pane \; send-keys -X select-word

# Triple click to select line (without canceling copy mode)
bind -T copy-mode-vi TripleClick1Pane select-pane \; send-keys -X select-line

# Stay in copy mode after mouse selection
unbind -T copy-mode-vi MouseDragEnd1Pane

bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"

run '~/.tmux/plugins/tpm/tpm'
